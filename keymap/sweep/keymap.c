#include QMK_KEYBOARD_H
#include "version.h"
#include "timer.h"
#include "keymap_french.h"
#include "config.h"


const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {

/*
 * ,--------------------------------------------.    ,--------------------------------------------.
 * |    0   |    1   |    2   |    3   |    4   |    |   17   |   18   |   19   |   20   |   21   |
 * |--------+--------+--------+--------+--------|    |--------+--------+--------+--------+--------|
 * |    5   |    6   |    7   |    8   |    9   |    |   22   |   23   |   24   |   25   |   26   |
 * |--------+--------+--------+--------+--------|    |--------+--------+--------+--------+--------|
 * |   10   |   11   |   12   |   13   |   14   |    |   27   |   28   |   29   |   30   |   31   |
 * `--------------------------------------------'    `--------------------------------------------'
 *
 *                            ,-----------------.    ,-----------------.
 *                            |   15   |   16   |    |   32   |   33   |
 *                            `-----------------'    `-----------------'
 */

// ,--------------------------------------------.    ,--------------------------------------------.
//   _______, _______, _______, _______, _______,      _______, _______, _______, _______, _______,
// |--------+--------+--------+--------+--------|    |--------+--------+--------+--------+--------|
//   _______, _______, _______, _______, _______,      _______, _______, _______, _______, _______,
// |--------+--------+--------+--------+--------|    |--------+--------+--------+--------+--------|
//   _______, _______, _______, _______, _______,      _______, _______, _______, _______, _______,
// `--------------------------------------------'    `--------------------------------------------'
//
//                            ,-----------------.    ,-----------------.
//                              _______, _______,      _______, _______,
//                            `-----------------'    `-----------------'


[0] = LAYOUT_split_3x5_2(
// ,--------------------------------------------.    ,--------------------------------------------.
     CTL_Q  , FR_W   , FR_E   , FR_R   , FR_T   ,      FR_Y   , FR_U   , FR_I   , FR_O   , CTL_P  ,
// |--------+--------+--------+--------+--------|    |--------+--------+--------+--------+--------|
     SFT_A  , GUI_S  , ALT_D  , LT2_F  , FR_G   ,      FR_H   , LT2_J  , ALT_K   , GUI_L , SFT_COL,
// |--------+--------+--------+--------+--------|    |--------+--------+--------+--------+--------|
     FR_Z   , FR_X   , FR_C   , LT3_V  , FR_B   ,      FR_N   , FR_M  , FR_COMM, FR_DOT , FR_SLSH,
// `--------------------------------------------'    `--------------------------------------------'

//                            ,-----------------.    ,-----------------.
                                LT1_ESC, KC_SPC ,      LT1_ENT, KC_BSPC
//                            `-----------------'    `-----------------'
),

[1] = LAYOUT_split_3x5_2(
// ,--------------------------------------------.    ,--------------------------------------------.
     FR_EXLM, FR_AT  , FR_LCBR, FR_RCBR, FR_PIPE,      FR_BSLS, FR_QUOT, FR_EQL , _______, FR_ASTR,
// |--------+--------+--------+--------+--------|    |--------+--------+--------+--------+--------|
     SFT_ASH, FR_DLR , FR_LPRN, FR_RPRN, _______,      KC_LEFT, KC_DOWN, KC_UP  , KC_RGHT, SFT_PLS,
// |--------+--------+--------+--------+--------|    |--------+--------+--------+--------+--------|
     FR_PERC, FR_CIRC, FR_LBRC, FR_RBRC, FR_TILD,      FR_AMPR, FR_MINS, FR_GRV , _______, FR_BSLS,
// `--------------------------------------------'    `--------------------------------------------'

//                            ,-----------------.    ,-----------------.
                                _______, _______,      _______, _______
//                            `-----------------'    `-----------------'
),

[2] = LAYOUT_split_3x5_2(
// ,--------------------------------------------.    ,--------------------------------------------.
     KC_CAPS, KC_HOME, KC_END , KC_PGUP, KC_PGDN,     _______, KC_MPRV, KC_MNXT, KC_MPLY, _______,
// |--------+--------+--------+--------+--------|    |--------+--------+--------+--------+--------|
     KC_LSFT, KC_ACL1, KC_ACL2, _______, _______,      KC_MS_L, KC_MS_D, KC_MS_U, KC_MS_R, KC_LSFT,
// |--------+--------+--------+--------+--------|    |--------+--------+--------+--------+--------|
     QK_BOOT, KC_BRIU, KC_BRID, _______, _______,      _______, KC_VOLD, KC_VOLU, KC_MUTE, _______,
// `--------------------------------------------'    `--------------------------------------------'

//                            ,-----------------.    ,-----------------.
                                KC_BTN1, KC_BTN2,      KC_BTN4, KC_BTN5
//                            `-----------------'    `-----------------'
),

[3] = LAYOUT_split_3x5_2(
// ,--------------------------------------------.    ,--------------------------------------------.
     _______, _______, _______, _______, _______,      _______, FR_7   , FR_8   , FR_9   , _______,
// |--------+--------+--------+--------+--------|    |--------+--------+--------+--------+--------|
     _______, _______, _______, _______, _______,      _______, FR_4   , FR_5   , FR_6   , _______,
// |--------+--------+--------+--------+--------|    |--------+--------+--------+--------+--------|
     _______, _______, _______, _______, _______,      FR_0   , FR_1   , FR_2   , FR_3   , _______,
// `--------------------------------------------'    `--------------------------------------------'

//                            ,-----------------.    ,-----------------.
                                _______, _______,      _______, _______
//                            `-----------------'    `-----------------'

)
};


/* === PROCESS === */
void keyboard_pre_init_user(void) {
  // Disable power led of MCU
  setPinOutput(24);
  writePinHigh(24);
}

void keyboard_post_init_user(void) {
    // Initialize RGB to static black
    rgblight_enable_noeeprom();
    rgblight_sethsv_noeeprom(HSV_BLACK);
    rgblight_mode_noeeprom(RGBLIGHT_MODE_STATIC_LIGHT);
}

bool caps_word_press_user(uint16_t keycode) {
    switch (keycode) {
        // Keycodes that continue Caps Word, with shift applied.
        case KC_A ... KC_Z:
        case FR_M:
            add_weak_mods(MOD_BIT(KC_LSFT));
            return true;

        // Keycodes that continue Caps Word, without shifting.
        case FR_0:
        case FR_1:
        case FR_2:
        case FR_3:
        case FR_4:
        case FR_5:
        case FR_6:
        case FR_7:
        case FR_8:
        case FR_9:
        case KC_BSPC:
        case KC_DEL:
        case FR_UNDS:
        case KC_LSFT:
        case LT3_V:
        case FR_MINS:
            return true;

        default:
            return false;  // Deactivate Caps Word.
    }
}
